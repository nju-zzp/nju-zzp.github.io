[{"content":" Name: ğŸŒŠ River Zhang Major: ğŸ§‘â€ğŸ“ Master of Software Engineering, Nanjing University Hobby: 1ï¸âƒ£ Western Culture 2ï¸âƒ£ Reading 3ï¸âƒ£ Films 4ï¸âƒ£ Walking in Nature Intro: ğŸŒˆ ä¸€ä¸ªå°å°çš„è‡ªç•™åœ°ï¼Œå¸Œæœ›äºå¹¿é˜”æ— å çš„å®‡å®™é‡Œï¼Œç•™ä¸‹ç‹¬ä¸€æ— äºŒçš„ç—•è¿¹ Email: ğŸ“® 191870267@smail.nju.edu.cn ","permalink":"http://124.222.233.153/about/","summary":"Name: ğŸŒŠ River Zhang Major: ğŸ§‘â€ğŸ“ Master of Software Engineering, Nanjing University Hobby: 1ï¸âƒ£ Western Culture 2ï¸âƒ£ Reading 3ï¸âƒ£ Films 4ï¸âƒ£ Walking in Nature Intro: ğŸŒˆ ä¸€ä¸ªå°å°çš„è‡ªç•™åœ°ï¼Œå¸Œæœ›äºå¹¿é˜”æ— å çš„å®‡å®™é‡Œï¼Œç•™ä¸‹ç‹¬ä¸€æ— äºŒçš„ç—•è¿¹ Email: ğŸ“® 191870267@smail.nju.edu.cn","title":"ğŸ¥° About Me"},{"content":" äºšæ—çš„å°å±‹ My undergraduate roommate\u0026#39;s home page~ ","permalink":"http://124.222.233.153/friends/","summary":"äºšæ—çš„å°å±‹ My undergraduate roommate\u0026#39;s home page~","title":"ğŸ¤ Friend Links"},{"content":"kafka å…¥é—¨æŒ‡å— 1. kafka åŸºæœ¬æ¦‚å¿µä¸åŸºæœ¬æ¶æ„ 2. kafka å•æœºç¯å¢ƒæ­å»º ä¸ å¯åŠ¨ å‚è€ƒï¼š\nhttps://blog.csdn.net/CSDN877425287/article/details/108836682 https://www.cnblogs.com/qpf1/p/9161742.html æ‰©å±•ï¼ˆkafkaç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æŒ‡å—ï¼‰:\nkafkaç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æŒ‡å—\n2.1 ä¸‹è½½Kafkaå®‰è£…åŒ…ä¸Šä¼ æœåŠ¡å™¨ kafkaå®˜ç½‘\nscp æŒ‡ä»¤ä¸Šä¼ æœåŠ¡å™¨\ntar xzvf kafka_2.12-2.1.0.tgz -C /home/ubuntu/environments\n2.2 é…ç½®zookeeperé…ç½® æ— éœ€å•ç‹¬ä¸‹è½½ï¼Œå·²ç»é›†æˆ\nvim ./kafka_2.12-2.1.0/config/zookeeper.properties\nå¦‚æœkafkaå’Œzkæ˜¯å•èŠ‚ç‚¹è¿è¡Œçš„è¯ä½¿ç”¨kafkaçš„é»˜è®¤é…ç½®å³å¯\n#é›†ç¾¤é…ç½®-å•èŠ‚ç‚¹æ— éœ€é…ç½® server.1=192.168.0.187:2888:3888 server.2=192.168.0.188:2888:3888 server.3=192.168.0.189:2888:3888 dataDir zkæ•°æ®å­˜æ”¾ç›®å½•\ndataLogDir zkæ—¥å¿—å­˜æ”¾ç›®å½•\nclientPort å®¢æˆ·ç«¯è¿æ¥zkæœåŠ¡çš„ç«¯å£\ntickTime zkæœåŠ¡å™¨ä¹‹é—´æˆ–è€…å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´ç»´æŒå¿ƒè·³çš„æ—¶é—´é—´éš”\ninitLimit å…è®¸followerï¼ˆç›¸å¯¹äºLeadererè¨€çš„ï¼Œå®¢æˆ·ç«¯ï¼‰è¿æ¥å¹¶åŒæ­¥åˆ°Leaderçš„åˆå§‹åŒ–è¿æ¥æ—¶é—´ï¼Œä»¥tickTimeä¸ºå•ä½ï¼Œå½“åˆå§‹åŒ–è¿æ¥æ—¶é—´è¶…è¿‡è¯¥å€¼ï¼Œåˆ™è¡¨ç¤ºè¿æ¥å¤±è´¥ã€‚\nsyncLimit LeaderäºFollowerä¹‹é—´å‘é€æ¶ˆæ¯æ—¶ï¼Œè¯·æ±‚å’Œç­”åº”æ—¶é—´é•¿åº¦ï¼Œå¦‚æœfollowåœ¨è®¾ç½®æ—¶é—´å†…ä¸èƒ½ä¸leaderé€šä¿¡ï¼Œé‚£ä¹ˆæ­¤followerå°†ä¼šè¢«ä¸¢å¼ƒ\nserver.1=192.168.0.187:2888:3888 2888æ˜¯followeräºleaderå‡ç¼“ä¿¡æ¯çš„ç«¯å£ï¼Œ3888å½“leaderäº¤æ¢ä¿¡æ¯çš„ç«¯å£ï¼Œ3888æ˜¯å½“leaderæŒ‚äº†æ—¶ç”¨æ¥æ‰§è¡Œé€‰ä¸¾æ˜¯æœåŠ¡å™¨äº’ç›¸é€šä¿¡çš„ç«¯å£\n2.3 é…ç½®kafkaé…ç½®ï¼ˆserverï¼‰ å¦‚æœkafkaå’Œzkæ˜¯å•èŠ‚ç‚¹è¿è¡Œçš„è¯ä½¿ç”¨kafkaçš„é»˜è®¤é…ç½®å³å¯\nå…³é”®ï¼š\nlog.dirså’Œzookeeper.connectã€‚å‰è€…æ˜¯æ—¥å¿—å­˜æ”¾æ–‡ä»¶å¤¹ï¼Œåè€…æ˜¯zookeeperè¿æ¥åœ°å€ï¼ˆç«¯å£å’ŒclientPortä¿æŒä¸€è‡´ï¼‰ã€‚\nlisteners advertised.listenersï¼ˆå¯¹å¤–å®£æ‰¬/æš´éœ²çš„åœ°å€å’Œç«¯å£ï¼Œæ¯”å¦‚å¯¹ç”Ÿäº§è€…ã€æ¶ˆè´¹è€…æš´éœ²ï¼‰ åœ¨å…¬å¸å†…ç½‘éƒ¨ç½² kafka é›†ç¾¤åªéœ€è¦ç”¨åˆ° listenersï¼Œå†…å¤–ç½‘éœ€è¦ä½œåŒºåˆ†æ—¶ æ‰éœ€è¦ç”¨åˆ°advertised.listenersã€‚\nadvertised_listeners ç›‘å¬å™¨ä¼šæ³¨å†Œåœ¨ zookeeper ä¸­ï¼›\nå½“æˆ‘ä»¬å¯¹ 172.17.0.10:9092 è¯·æ±‚å»ºç«‹è¿æ¥ï¼Œkafka æœåŠ¡å™¨ä¼šé€šè¿‡ zookeeper ä¸­æ³¨å†Œçš„ç›‘å¬å™¨ï¼Œæ‰¾åˆ° INSIDE ç›‘å¬å™¨ï¼Œç„¶åé€šè¿‡ listeners ä¸­æ‰¾åˆ°å¯¹åº”çš„ é€šè®¯ ip å’Œ ç«¯å£ï¼›\nåŒç†ï¼Œå½“æˆ‘ä»¬å¯¹ \u0026lt;å…¬ç½‘ ip\u0026gt;:ç«¯å£ è¯·æ±‚å»ºç«‹è¿æ¥ï¼Œkafka æœåŠ¡å™¨ä¼šé€šè¿‡ zookeeper ä¸­æ³¨å†Œçš„ç›‘å¬å™¨ï¼Œæ‰¾åˆ° OUTSIDE ç›‘å¬å™¨ï¼Œç„¶åé€šè¿‡ listeners ä¸­æ‰¾åˆ°å¯¹åº”çš„ é€šè®¯ ip å’Œ ç«¯å£ 172.17.0.10:9094ï¼›\næ€»ç»“ï¼šadvertised_listeners æ˜¯å¯¹å¤–æš´éœ²çš„æœåŠ¡ç«¯å£ï¼ŒçœŸæ­£å»ºç«‹è¿æ¥ç”¨çš„æ˜¯ listenersã€‚\nåªæœ‰å†…ç½‘ï¼Œæ¯”å¦‚åœ¨å…¬å¸æ­å»ºçš„ kafka é›†ç¾¤ï¼Œåªæœ‰å†…ç½‘ä¸­çš„æœåŠ¡å¯ä»¥ç”¨ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œåªéœ€è¦ç”¨ listeners å°±è¡Œã€‚ å†…å¤–ç½‘ï¼Œæ¯”å¦‚åœ¨ docker ä¸­æˆ–è€… åœ¨ç±»ä¼¼é˜¿é‡Œäº‘ä¸»æœºä¸Šéƒ¨ç½² kafka é›†ç¾¤ï¼Œè¿™ç§æƒ…å†µä¸‹æ˜¯ éœ€è¦ç”¨åˆ° advertised_listeners broker.id=0\tæ¯ä¸ªserveréœ€è¦å•ç‹¬é…ç½®broker.idå¦‚æœä¸é…ç½®ç³»ç»Ÿä¼šæŒ‡å®šé…ç½®ï¼Œéœ€è¦å’Œä¸Šä¸€æ­¥IDä¸€è‡´ listeners=PLAINTEST://ip:9092\tç›‘å¬åœ°å€ï¼Œæ ¼å¼PLAINTESTï¼š//ipï¼šç«¯å£ num.network.threads=3\tæ¥æ”¶å’Œå‘é€ç½‘ç»œä¿¡æ¯çš„çº¿ç¨‹æ•° num.io.threads=8\tæœåŠ¡å™¨ç”¨äºå¤„ç†è¯·æ±‚çš„çº¿ç¨‹æ•°ï¼Œå…¶ä¸­å¯èƒ½åŒ…æ‹¬ç£ç›˜IO socket.send.buffer.bytes=102400\tå¥—æ¥å­—æœåŠ¡å™¨ä½¿ç”¨çš„å‘é€ç¼“å†²åŒºï¼ˆSO_SNDBUFï¼‰ socket.receive.buffer.bytes=102400\tå¥—æ¥å­—æœåŠ¡å™¨ä½¿ç”¨çš„æ¥æ”¶ç¼“å†²åŒºï¼ˆSO_RCVBUFï¼‰ socket.request.max.bytes=104857600\tå¥—æ¥å­—æœåŠ¡å™¨å°†æ¥æ”¶çš„è¯·æ±‚æœ€å¤§å¤§å°ï¼ˆé˜²æ­¢OOMï¼‰ log.dirs=/tmp/kafka-logs\tæ—¥å¿—æ–‡ä»¶ num.partitions=1\tpartitionsçš„æ•°é‡ num.recovery.threads.per.data.dir=1\tå¯åŠ¨æ—¶æ¢å¤æ—¥å¿—ï¼Œå…³é—­æ—¶åˆ·ç›˜æ—¥å¿—æ¯ä¸ªæ•°æ®ç›®å½•çš„çº¿ç¨‹çš„æ•°é‡ï¼Œé»˜è®¤1 offsets.topic.replication.factor=1\tåç§»é‡è¯é¢˜çš„å¤åˆ¶å› å­ï¼ˆè®¾ç½®æ›´é«˜ä¿è¯å¯ç”¨ï¼‰ï¼Œä¸ºä¿è¯æœ‰æ•ˆçš„çˆ¶å­ï¼Œåç§»é‡çš„å¤åˆ¶å› å­æ˜¯å¯é…ç½®çš„ï¼Œåœ¨åç§»è¯é¢˜çš„ç¬¬ä¸€æ¬¡è¯·æ±‚çš„æ—¶å€™å¯ç”¨borkerçš„æ•°é‡è‡³å°‘ä¸ºå¤åˆ¶å› å­çš„å¤§å°ï¼Œå¦åˆ™è¦ä¹ˆè¯é¢˜åˆ›å»ºå¤±è´¥ï¼Œè¦ä¹ˆå¤åˆ¶å› å­å–å¯ç”¨çš„æ•°é‡å’Œé…ç½®å¤åˆ¶å› å­å–æœ€å°å€¼ transaction.state.log.replication.factor=1 transaction.state.log.min.isr=1 log.retention.hours=168\tæ—¥å¿—æ–‡ä»¶åˆ é™¤ä¹‹å‰ä¿ç•™çš„æ—¶é—´ log.segment.bytes=1073741824\tå•ä¸ªæ—¥å¿—æ–‡ä»¶å¤§å°é»˜è®¤ä¸º1073741824 log.retention.check.interval.ms=300000\tæ£€æŸ¥æ—¥å¿—ç«¯ä»¥æŸ¥çœ‹æ˜¯å¦å¯ä»¥æ ¹æ®ä¿ç•™ç­–ç•¥åˆ é™¤ä»–ä»¬çš„æ—¶é—´é³„æ¢¨ zookeeper.connect=zkip:2181\tzkä¸»æœºåœ°å€ï¼Œå¦‚æœæ˜¯zké›†ç¾¤ä»¥é€—å·åˆ†éš” zookeeper.connection.timeout.ms=6000\tè¿æ¥zkçš„è¶…æ—¶æ—¶é—´ group.initial.rebalance.delay.ms=0 2.4 åå°å¯åŠ¨zookeeperå¹¶æ£€éªŒæ˜¯å¦è¿è¡ŒæˆåŠŸ cd kafka_2.12-2.1.0/ nohup bin/zookeeper-server-start.sh config/zookeeper.properties \u0026amp; nohup bin/zookeeper-server-start.sh config/zookeeper.properties \u0026gt; zookeeper-run.log 2\u0026gt;\u0026amp;1 \u0026amp; echo conf | nc localhost 2181 echo stat | nc localhost 2181 2.5 åå°å¯åŠ¨kafka nohup bin/kafka-server-start.sh config/server.properties \u0026gt; kafka-run.log 2\u0026gt;\u0026amp;1 \u0026amp; 2.6 åˆ›å»ºå¹¶æŸ¥çœ‹topic ubuntu$\u0026gt; ./bin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 1 --partitions 1 --topic test Created topic \u0026#34;test\u0026#34;. ubuntu$\u0026gt; ./bin/kafka-topics.sh --zookeeper localhost:2181 --list test 3. JAVAå®ç° Kafka Producer 3.1 æ–¹å¼ä¸€ï¼škafka-clients APIå‚è€ƒï¼šhttps://kafka.apache.org/33/javadoc/index.html?org/apache/kafka/clients/producer/KafkaProducer.html\nç”Ÿäº§è€…è¯¦è§£ã€è¿›é˜¶å‚è€ƒï¼šhttps://www.jianshu.com/p/37ea14d1d4abï¼ˆä¸»è¦åŒ…å«ç”Ÿäº§è€…å‚æ•°é…ç½®ã€æ¶ˆæ¯åºåˆ—åŒ–ã€è‡ªå®šä¹‰åˆ†åŒºï¼‰\nå¼•å…¥kafka-clientsä¾èµ– \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.apache.kafka\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;kafka-clients\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.1.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; åˆ›å»ºç”Ÿäº§è€… KafkaProducer KafkaProducer API: https://kafka.apache.org/33/javadoc/index.html?org/apache/kafka/clients/producer/KafkaProducer.html\nå‘ Kafka å†™å…¥æ¶ˆæ¯ï¼Œé¦–å…ˆè¦åˆ›å»ºä¸€ä¸ªç”Ÿäº§è€…å¯¹è±¡ï¼Œè¯¥å¯¹è±¡æœ‰3ä¸ªå¿…è¦å±æ€§ã€‚\nbootstrap.servers æŒ‡å®š broker çš„åœ°å€åˆ—è¡¨ï¼Œåœ°å€çš„æ ¼å¼ä¸º host:portã€‚ ä¸éœ€è¦åŒ…å«æ‰€æœ‰çš„ broker åœ°å€ï¼Œç”Ÿäº§è€…ä¼šé€šè¿‡ç»™å®šçš„ broker æŸ¥æ‰¾åˆ°å…¶ä»– broker çš„ä¿¡æ¯ã€‚å»ºè®®è‡³å°‘æä¾›ä¸¤ä¸ª broker çš„ä¿¡æ¯ï¼Œé˜²æ­¢å…¶ä¸­ä¸€ä¸ªå®•æœºã€‚ key.serializer Kafka å®¢æˆ·ç«¯é»˜è®¤æä¾›äº† ByteArraySerializerã€ StringSerializer å’Œ IntegerSerializerï¼Œå› æ­¤å¦‚æœä½¿ç”¨å¸¸è§çš„ Java å¯¹è±¡ç±»å‹ï¼Œä¸éœ€è¦å®ç°è‡ªå·±çš„åºåˆ—åŒ–å™¨ ã€‚å¦‚æœè¦è‡ªå®šä¹‰åºåˆ—åŒ–å™¨ï¼Œéœ€è¦å®ç° org.apache.kafka.common.serialization.Serializer æ¥å£ã€‚ éœ€è¦æ³¨æ„ï¼Œkey.serializer æ˜¯å¿…é¡»è®¾ç½®çš„ï¼Œå³ä½¿åªå‘é€å€¼ç±»å‹ã€‚ value.serializer ä¸ key.serializer ä¸€æ ·ï¼Œ value.serializer æŒ‡å®šçš„ç±»ä¼šå°†å€¼åºåˆ—åŒ–å‘é€ç»™ brokerã€‚ Properties kafkaProps = new Properties(); kafkaProps.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, \u0026#34;kafka-broker-ip:9092\u0026#34;); kafkaProps.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName()); kafkaProps.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName()); KafkaProducer\u0026lt;String, String\u0026gt; producer = new KafkaProducer\u0026lt;String, String\u0026gt;(kafkaProps); å‘é€æ¶ˆæ¯ å®ä¾‹åŒ–ç”Ÿäº§è€…å¯¹è±¡åï¼Œå°±å¯ä»¥å¼€å§‹é€æ¶ˆæ¯äº†ã€‚å‘é€æ¶ˆæ¯ä¸»è¦æœ‰ä»¥ä¸‹ 3 ç§æ–¹å¼ï¼š\nå‘é€å¹¶å¿˜è®°ï¼ˆfire-and-forgetï¼‰ æŠŠæ¶ˆæ¯å‘é€ç»™æœåŠ¡å™¨ï¼Œä¸å…³å¿ƒæ˜¯å¦æ­£å¸¸åˆ°è¾¾ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ¶ˆæ¯ä¼šæ­£å¸¸åˆ°è¾¾ï¼Œå› ä¸º Kafka æ˜¯é«˜å¯ç”¨çš„ï¼Œè€Œä¸”ç”Ÿäº§è€…ä¼šè‡ªåŠ¨å°è¯•é‡å‘ã€‚ä¸è¿‡ï¼Œä½¿ç”¨è¿™ç§æ–¹å¼æœ‰æ—¶å€™ä¹Ÿä¼šä¸¢å¤±ä¸€äº›æ¶ˆæ¯ã€‚ åŒæ­¥å‘é€ï¼ˆasyncï¼‰ ä½¿ç”¨ send() æ–¹æ³•å‘é€æ¶ˆæ¯ï¼Œä¼šè¿”å›ä¸€ä¸ª Future å¯¹è±¡ï¼Œè°ƒç”¨ get() æ–¹æ³•é˜»å¡ç­‰å¾…è¿”å›ï¼Œè¿”å›ç»“æœçŸ¥é“æ˜¯å¦å‘é€æˆåŠŸã€‚ å¼‚æ­¥å‘é€ï¼ˆsyncï¼‰ï¼ˆæœ€ç®€å•æœ€å¸¸ç”¨ï¼‰ ä½¿ç”¨ send() æ–¹æ³•å¹¶æŒ‡å®šä¸€ä¸ªå›è°ƒå‡½æ•°ï¼ŒæœåŠ¡å™¨åœ¨è¿”å›å“åº”æ—¶è°ƒç”¨è¯¥å‡½æ•°ã€‚ æ ¸å¿ƒå¯¹è±¡ï¼š\næ¶ˆæ¯å¯¹è±¡ ProducerRecord : https://kafka.apache.org/33/javadoc/index.html?org/apache/kafka/clients/producer/KafkaProducer.html æ¶ˆæ¯è®°å½•çš„å­˜å‚¨ä¿¡æ¯ RecordMetadataï¼š https://kafka.apache.org/33/javadoc/index.html?org/apache/kafka/clients/producer/KafkaProducer.htmlï¼ˆsend(...).get()è¿”å›å¯¹è±¡ï¼‰ ä¾‹å­ä½¿ç”¨äº†ScheduledExecutorServiveï¼ˆå³ScheduledThreadPoolï¼‰æ¥è¿›è¡Œå®šæ—¶ä»»åŠ¡\nScheduledExecutorService scheduledExecutor = Executors.newScheduledThreadPool(5); scheduledExecutor.scheduleAtFixedRate(() -\u0026gt; { try { RecordMetadata recordMetadata = producer.send(new ProducerRecord\u0026lt;String, String\u0026gt;(\u0026#34;test\u0026#34;, \u0026#34;time\u0026#34;, new Date().toString())).get(); System.out.println(\u0026#34;Success: OFFSET-\u0026#34;+recordMetadata.offset()); } catch (InterruptedException e) { System.out.println(\u0026#34;ERROR\u0026#34;); throw new RuntimeException(e); } catch (ExecutionException e) { System.out.println(\u0026#34;ERROR\u0026#34;); throw new RuntimeException(e); } }, 0, 2, TimeUnit.SECONDS); 4. JAVAå®ç° Kafka Consumer 4.1 æ–¹å¼ä¸€ï¼škafç™»å½•ï¼Œæ–‡ä»¶æäº¤åè‡ªåŠ¨é‡å‘½åï¼Œæ”¯æŒæ”¶é›†ä»»æ„æ ¼å¼æ–‡ä»¶ã€‚ æ­é…åšæœäº‘ka-clients\nAPI å‚è€ƒï¼šhttps://kafka.apache.org/33/javadoc/org/apache/kafka/clients/consumer/package-frame.html\næ¶ˆè´¹è€…è¯¦è§£ã€è¿›é˜¶å‚è€ƒï¼šhttps://www.jianshu.com/p/1f9e18e926f6ï¼ˆä¸»è¦åŒ…æ‹¬æ¶ˆè´¹è€…å‚æ•°é…ç½®\nå¼•å…¥kafka-clientsä¾èµ– \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.apache.kafka\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;kafka-clients\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.1.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; åˆ›å»ºæ¶ˆè´¹è€… KafkaConsumer KafkaConsumerå¯¹è±¡APIï¼šhttps://kafka.apache.org/33/javadoc/index.html?org/apache/kafka/clients/consumer/KafkaConsumer.html ConsumerConfig APIï¼šhttps://kafka.apache.org/33/javadoc/org/apache/kafka/clients/consumer/ConsumerConfig.html auto.offset.resetï¼šå½“ä¸å­˜åœ¨åˆå§‹åç§»é‡æˆ–æœåŠ¡å™¨ä¸Šä¸å†å­˜åœ¨å½“å‰åç§»é‡æ—¶ï¼Œæ­¤å±æ€§æ˜¯å¿…éœ€çš„ã€‚åªæœ‰ä»¥ä¸‹ä¸‰ä¸ªå€¼å¯ç”¨äºé‡ç½®åç§»å€¼ï¼š\nWhat to do when there is no initial offset in Kafka or if the current offset does not exist any more on the server (e.g. because that data has been deleted):\nearliest: automatically reset the offset to the earliest offsetlatest: automatically reset the offset to the latest offsetnone: throw exception to the consumer if no previous offset is found for the consumer\\'s groupanything else: throw exception to the consumer. æŒ‡å®šäº†æ¶ˆè´¹è€…åœ¨è¯»å–ä¸€ä¸ªæ²¡æœ‰åç§»é‡ï¼ˆoffsetï¼‰çš„åˆ†åŒºæˆ–è€…åç§»é‡æ— æ•ˆçš„æƒ…å†µä¸‹ï¼ˆå› æ¶ˆè´¹è€…é•¿æ—¶é—´å¤±æ•ˆï¼ŒåŒ…å«åç§»é‡çš„è®°å½•å·²ç»è¿‡æ—¶äº•è¢«åˆ é™¤ï¼‰è¯¥ä½œä½•å¤„ç†ï¼Œé»˜è®¤å€¼æ˜¯ latestï¼Œè¡¨ç¤ºåœ¨ offset æ— æ•ˆçš„æƒ…å†µä¸‹ï¼Œæ¶ˆè´¹è€…å°†ä»æœ€æ–°çš„è®°å½•å¼€å§‹è¯»å–æ•°æ®ï¼ˆåœ¨æ¶ˆè´¹è€…å¯åŠ¨ä¹‹åç”Ÿæˆçš„è®°å½•ï¼‰ã€‚\nProperties props = new Properties(); props.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, \u0026#34;124.222.233.153:9092\u0026#34;); props.put(ConsumerConfig.GROUP_ID_CONFIG, \u0026#34;191870267-0\u0026#34;); props.put(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class.getName()); props.put(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class.getName()); props.put(ConsumerConfig.AUTO_OFFSET_RESET_CONFIG, \u0026#34;earliest\u0026#34;); props.put(ConsumerConfig.MAX_POLL_RECORDS_CONFIG, \u0026#34;10\u0026#34;); KafkaConsumer\u0026lt;String, String\u0026gt; consumer = new KafkaConsumer\u0026lt;String, String\u0026gt;(props); è®¢é˜…ä¸»é¢˜Topic consumer.subscribe(Collections.singleton(\u0026#34;test\u0026#34;)); æ¶ˆè´¹è½®è¯¢ï¼ˆæ ¸å¿ƒï¼‰ æ¶ˆæ¯è½®è¯¢æ˜¯æ¶ˆè´¹è€…çš„æ ¸å¿ƒï¼Œé€šè¿‡è½®è¯¢å‘æœåŠ¡å™¨è¯·æ±‚æ•°æ®ã€‚æ¶ˆæ¯è½®è¯¢ API ä¼šå¤„ç†æ‰€æœ‰çš„ç»†èŠ‚ï¼ŒåŒ…æ‹¬ç¾¤ç»„åè°ƒã€åˆ†åŒºå†å‡è¡¡ã€å‘é€å¿ƒè·³å’Œè·å–æ•°æ®ï¼Œå¼€å‘è€…åªéœ€è¦å¤„ç†ä»åˆ†åŒºè¿”å›çš„æ•°æ®ã€‚\nwhile (true) { ConsumerRecords\u0026lt;String, String\u0026gt; records = consumer.poll(Duration.ofSeconds(5)); for(ConsumerRecord\u0026lt;String, String\u0026gt; record : records) { System.out.println(\u0026#34;{offset=\u0026#34; + record.offset() + \u0026#34; , key=\u0026#34; + record.key() + \u0026#34; , value=\u0026#34; + record.value() + \u0026#34; , timestamp=\u0026#34; + record.timestamp() + \u0026#34; }\u0026#34;); } System.out.println(); } ","permalink":"http://124.222.233.153/posts/tech/se/kafka-start/","summary":"\u003ch1 id=\"kafka-å…¥é—¨æŒ‡å—\"\u003ekafka å…¥é—¨æŒ‡å—\u003c/h1\u003e\n\u003ch2 id=\"1-kafka-åŸºæœ¬æ¦‚å¿µä¸åŸºæœ¬æ¶æ„\"\u003e1. kafka åŸºæœ¬æ¦‚å¿µä¸åŸºæœ¬æ¶æ„\u003c/h2\u003e\n\u003ch2 id=\"2-kafka-å•æœºç¯å¢ƒæ­å»º-ä¸-å¯åŠ¨\"\u003e2. kafka å•æœºç¯å¢ƒæ­å»º ä¸ å¯åŠ¨\u003c/h2\u003e","title":"Kafka Start"}]